@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix ex: <http://example.com/ns#>.
@prefix foaf: <http://xmlns.com/foaf/0.1/>.
@prefix dc: <http://purl.org/dc/terms/>.
@prefix vcard: <http://www.w3.org/2006/vcard/ns#>.
@prefix dcterms: <http://purl.org/dc/terms/>.
@prefix skos: <http://www.w3.org/2004/02/skos/core#>.
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix vcad: <http://www.sefaz.ma.gov.br/ontology/> .
@prefix sd: <http://www.w3.org/ns/sparql-service-description#> .
@prefix prov: <http://www.w3.org/ns/prov#> .

<#DB_source> a d2rq:Database;
    d2rq:jdbcDSN "jdbc:postgresql://localhost:5432/postgres";
    d2rq:jdbcDriver "org.postgresql.Driver";
    d2rq:username "postgres";
    d2rq:password "123456".

<#LogicalSource> a rml:LogicalSource;
    rml:source <#DB_source>;
    rr:sqlVersion rr:SQL2008;
    rr:tableName ""; 
    rml:query "SELECT CNPJ, RAZAO_SOCIAL, NOME_FANTASIA,
            (CNPJ||'-'||CASE 
                WHEN NOME_FANTASIA = '                                  ' THEN RAZAO_SOCIAL
                WHEN NOME_FANTASIA IS NULL THEN RAZAO_SOCIAL
                ELSE NOME_FANTASIA 
            END) AS ROTULO,
            EMAIL, TELEFONE_1, TELEFONE_2, ID_ENDERECO
            FROM RFB_ESTABELECIMENTO@BIGSEM;";
    rml:referenceFormulation ql:CSV.

<#MyTriplesMap> a rr:TriplesMap;
      rml:logicalSource <#LogicalSource>;

      rr:subjectMap [
        rr:template "http://www.sefaz.ma.gov.br/resource/RFB/Estabelecimento/{CNPJ}";
        rr:class http://www.sefaz.ma.gov.br/RFB/ontology/Estabelecimento
    ];

      
      .

