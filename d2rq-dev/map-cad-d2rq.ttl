@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix ex: <http://example.com/ns#>.
@prefix foaf: <http://xmlns.com/foaf/0.1/>.
@prefix dc: <http://purl.org/dc/elements/1.1/>.
@prefix vcard: <http://www.w3.org/2006/vcard/ns#>.
@prefix dcterms: <http://purl.org/dc/terms/>.
@prefix skos: <http://www.w3.org/2004/02/skos/core#>.
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix sfz: <http://www.sefaz.ma.gov.br/ontology/> .
@prefix map: <http://sistemas.sefaz.ma.gov.br/maps/RFB/2020-04-01> .
@prefix sd: <http://www.w3.org/ns/sparql-service-description#> .
@prefix prov: <http://www.w3.org/ns/prov#> .

# MAPEAMENTO DE ESTABELECIMENTO - CADASTRO SEFAZ
            # SELECT CNPJ, INSCRICAO_ESTADUAL, NOME_FANTASIA, EMAIL, TELEFONE,
map:ESTABELECIMENTO_CAD a rr:TriplesMap;
    rr:logicalTable [
        rr:sqlQuery """
            SELECT CNPJ, INSCRICAO_ESTADUAL, NOME_FANTASIA, EMAIL, TELEFONE 
            FROM "UFC2"."CAD_ESTABELECIMENTO_MAT"
            WHERE ROWNUM <= 10
        """
    ];
    rr:subjectMap [
        rr:template "http://www.sefaz.ma.gov.br/resource/CAD/Estabelecimento/{\"CNPJ\"}" ;
        # rr:class sfz:Estabelecimento, sfz:EstabelecimentoCAD; 
        rr:class sfz:EstabelecimentoCAD; #Inferir sfz:Estabelecimento apenas nas consultas;
        rr:graph sfz:Estabelecimento_CAD
    ] ;
    rr:predicateObjectMap [
        rr:predicate sfz:cnpj;
        rr:objectMap [
            rr:column '"CNPJ"';
            rr:datatype xsd:nonNegativeInteger
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate sfz:inscricao_estadual;
        rr:objectMap [
            rr:column '"INSCRICAO_ESTADUAL"';
            rr:datatype xsd:nonNegativeInteger
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate sfz:nome_fantasia;
        rr:objectMap [
            rr:column '"NOME_FANTASIA"';
            rr:datatype xsd:string
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate sfz:email;
        rr:objectMap [
            rr:column '"EMAIL"';
            rr:datatype xsd:string
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate sfz:telefone;
        rr:objectMap [
            rr:column '"TELEFONE"';
            rr:datatype xsd:string
        ];
    ].
    # rr:predicateObjectMap [
    #     rr:predicate sfz:tem_endereco;
    #     rr:objectMap [
    #         rr:parentTriplesMap map:ENDERECO_CAD;
    #         rr:joinCondition [
    #             rr:child "CNPJ";
    #             rr:parent "CNPJ";
    #         ];

    #     ];
    # ].



# MAPEAMENTO DE ENDEREÃ‡O - CADASTRO SEFAZ: TEM CNPJ QUE LIGA AO ESTABELECIMENTO
# map:ENDERECO_CAD a rr:TriplesMap;
#     rr:logicalTable [
#         rr:sqlQuery """
#             SELECT ID, CNPJ, LOGRADOURO, NUMERO, CEP, CIDADE, ESTADO, COMPLEMENTO FROM "UFC2"."CAD_ENDERECO" WHERE ROWNUM <= 5;
#         """
#     ];
#     rr:subjectMap [
#         rr:template "http://www.sefaz.ma.gov.br/resource/CAD/Endereco/{CNPJ}" ;
#         rr:class sfz:Endereco, sfz:EnderecoCAD;
#     ];
#     rr:predicateObjectMap [
#         rr:predicate sfz:logradouro;
#         rr:objectMap [
#             rr:column '"LOGRADOURO"';
#             rr:datatype xsd:string
#         ];
#     ];
#     rr:predicateObjectMap [
#         rr:predicate sfz:numero;
#         rr:objectMap [
#             rr:column '"NUMERO"';
#             rr:datatype xsd:string
#         ];
#     ];
#     rr:predicateObjectMap [
#         rr:predicate sfz:cep;
#         rr:objectMap [
#             rr:column '"CEP"';
#             rr:datatype xsd:string
#         ];
#     ];
#     rr:predicateObjectMap [
#         rr:predicate sfz:cidade;
#         rr:objectMap [
#             rr:column '"CIDADE"';
#             rr:datatype xsd:string
#         ];
#     ];
#     rr:predicateObjectMap [
#         rr:predicate sfz:estado;
#         rr:objectMap [
#             rr:column '"ESTADO"';
#             rr:datatype xsd:string
#         ];
#     ];
#     rr:predicateObjectMap [
#         rr:predicate sfz:complemento;
#         rr:objectMap [
#             rr:column '"COMPLEMENTO"';
#             rr:datatype xsd:string
#         ];
#     ].